<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>A-Frame VR İçeriği</title>
  <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
  <!-- vr-mode-ui bileşenini ekleyin -->
  <!--<script src="node_modules/aframe/dist/aframe.min.js"></script>-->
  <script src="https://cdn.rawgit.com/donmccurdy/aframe-extras/v6.1.0/dist/aframe-extras.min.js"></script>
  <script src="https://unpkg.com/browse/aframe-event-set-component@5.0.0/dist/aframe-event-set-component.min.js"></script>
  <script src="https://unpkg.com/super-hands@3.0.0/dist/super-hands.min.js"></script>
  <style>
     .label {
    text-align: center;
    width: 460px;
    height: 260px;
   /* border: 1px solid white;*/
   border: none;
    border-radius: 5px;
   /* background: rgba( 0, 0, 0, .6 );*/
  }
  </style>
</head>
<body>
    <script type="module">

//import * as THREE from "https://cdn.skypack.dev/three@0.136.0";
import {
CSS3DRenderer,
CSS3DObject
} from 'https://cdn.skypack.dev/three@0.136.0/examples/jsm/renderers/CSS3DRenderer.js';

        window.onload=function() {
           /* document.onclick=function() {
                document.querySelector('a-scene').enterVR();

            }*/
           // let scene = document.querySelector('a-entity').sceneEl.object3D;
           var scene=document.querySelector('a-scene').object3D;
            var cameraEl = document.querySelector('#camera');
           // var texture2 = THREE.ImageUtils.loadTexture('chevron.png');
//texture2.minFilter = THREE.LinearFilter; // Ekle, resmin daha iyi görünmesini sağlar.

var textureLoader = new THREE.TextureLoader();
      const texture2 = textureLoader.load('chevron.png');



var material2 = new THREE.MeshBasicMaterial({ map: texture2 });

/*var mesh78 = new THREE.Mesh(new THREE.PlaneGeometry(1, 1, 1, 1), material2);
mesh78.position.set(10, 10, 9);
mesh78.rotation.y=0.5;
scene.add(mesh78);*/

/*var texture = THREE.ImageUtils.loadTexture('chevron.png');
texture.minFilter = THREE.LinearFilter;*/

      const texture = textureLoader.load('chevron.png');



var material = new THREE.MeshBasicMaterial({ map: texture, transparent: true, opacity: 1 });

var radius = 3;
var segments = 32; // Dairenin kenar sayısı
var geometry = new THREE.CircleGeometry(radius, segments);

var mesh77 = new THREE.Mesh(geometry, material);
mesh77.position.set(-4, 5, -20.0);
mesh77.rotation.y=-0.5;
mesh77.scale.set(0.5,0.5,0.5);
scene.add(mesh77);
console.log(mesh77.scale.x);

var mesh78 = new THREE.Mesh(geometry, material);
mesh78.position.set(25, 4, 0);
mesh78.rotation.y=-1;
mesh78.scale.set(0.5,0.5,0.5);
scene.add(mesh78);

var initialScale = 0.5; // Başlangıç boyutu
var targetScale = 0.7; // Hedef boyutu
var scaleSpeed = 0.005; // Boyut değiştirme hızı

var growing = true; // Mesh büyüyor mu?

window.setInterval(function() {
  // Büyütme ve küçültme animasyonu
  if (growing) {
    mesh77.scale.x += scaleSpeed;
    mesh77.scale.y += scaleSpeed;
    mesh78.scale.x += scaleSpeed;
    mesh78.scale.y += scaleSpeed;
    if (mesh77.scale.x >= targetScale) {
      growing = false;
    }
  } else {
    mesh77.scale.x -= scaleSpeed;
    mesh77.scale.y -= scaleSpeed;
    mesh78.scale.x -= scaleSpeed;
    mesh78.scale.y -= scaleSpeed;
    if (mesh77.scale.x <= initialScale) {
      growing = true;
    }
  }
},100);

var image2='360-2/jpeg-optimizer_vecteezy_360-panorama-view-of-a-black-minimalist-interior-of-a-modern-home-in-3d-rendering_2081472.jpg';
var image1="360-2/jpeg-optimizer_vecteezy_360-panorama-view-of-a-black-minimalist-interior-of-a-modern-home-in-3d-rendering_2081474.jpg";
var image3="360-2/jpeg-optimizer_vecteezy_spherical-360-seamless-panorama-projection-of-an-interior-modern-design-room-in.jpg";
var image4="360-2/jpeg-optimizer_lavabo.jpg";
var mesh1,mesh2,mesh3,mesh4;

// Video elementini oluşturalım ve video dosyasını yükleyelim
var video = document.createElement('video');
video.src = '360/karasu.mp4'; // Video dosyanızın yolu buraya gelecek
video.loop = true;
video.muted = true; // Dikkat: otomatik ses çıkışı engellemek için video sesini kapatıyoruz
video.play();

// Video texture oluşturalım ve materyale ekleyelim
var texture3 = new THREE.VideoTexture(video);
//texture3.minFilter = THREE.LinearFilter;

var material3 = new THREE.MeshBasicMaterial({ map: texture3, transparent: true, opacity: 1 });

// Dairenin özelliklerini belirleyelim
var radius = 3;
var segments = 32; // Dairenin kenar sayısı
var geometry3 = new THREE.PlaneGeometry(14.3, 8);

// Mesh'i oluşturup sahneye ekleyelim
var mesh79 = new THREE.Mesh(geometry3, material3);
mesh79.position.set(-20, 1, -20.0);
mesh79.rotation.y = -0.01;
//mesh79.scale.set(0.5,0.5,0.5);
scene.add(mesh79);
//console.log(mesh79.rotation.y);

load4(image3);


function load4(image3) {
       // document.getElementsByClassName("container")[0].style.display="flex";
  var geometry = new THREE.SphereGeometry( 500, 40, 30 );
geometry.scale( - 1, 1, 1 );



var material = new THREE.MeshBasicMaterial({
  map: new THREE.TextureLoader().load( image3, function (texture) {
  // Yükleme tamamlandığında çalışacak işlev
  console.log('Texture loaded successfully:'+ texture);
    //document.getElementsByClassName("container")[0].style.display="none";
  new THREE.TextureLoader().load( image1);
new THREE.TextureLoader().load( image2);
new THREE.TextureLoader().load( image4);
},
function (xhr) {
  // Yükleme sırasında ilerleme raporları için çalışacak işlev
  var percentComplete = (xhr.loaded / xhr.total) * 100;
  console.log('Texture loading progress:'+ percentComplete + '%');
},
function (error) {
  // Yükleme sırasında bir hata oluşursa çalışacak işlev
  console.error('Error loading texture:'+ error);
} )
});

mesh3=new THREE.Mesh( geometry, material );
mesh3.material.transparent = true;
//target1=mesh3;

/*
{
  map: new THREE.TextureLoader().load( image3, function (texture) {
  // Yükleme tamamlandığında çalışacak işlev
  console.log('Texture loaded successfully:'+ texture);
    document.getElementsByClassName("container")[0].style.display="none";
  new THREE.TextureLoader().load( image1);
new THREE.TextureLoader().load( image2);
new THREE.TextureLoader().load( image4);
},
function (xhr) {
  // Yükleme sırasında ilerleme raporları için çalışacak işlev
  var percentComplete = (xhr.loaded / xhr.total) * 100;
  console.log('Texture loading progress:'+ percentComplete + '%');
},
function (error) {
  // Yükleme sırasında bir hata oluşursa çalışacak işlev
  console.error('Error loading texture:'+ error);
} )
}

*/

scene.add(mesh3);


}

//document.querySelector('a-scene').enterVR()


/*AFRAME.registerComponent('raycaster-autorefresh', {
      init: function () {
        var el = this.el;
        var cameraEl = document.querySelector('#camera');

        el.addEventListener('click', function (event) {
          var mouse = new THREE.Vector2();
          mouse.x = (event.detail.intersection.uv.x) * 2 - 1;
          mouse.y = -(event.detail.intersection.uv.y) * 2 + 1;

          var raycaster = new THREE.Raycaster();
          raycaster.setFromCamera(mouse, cameraEl.object3D);

          var intersects = raycaster.intersectObjects(el.sceneEl.object3D.children, true);

          if (intersects.length > 0) {
            for (var i = 0; i < intersects.length; i++) {
                alert("sasc");
              if (intersects[i].object.el === el) {
                if (el.getAttribute('id') === 'mesh77') {
                  alert("Mesh77'e tıklandı!");
                } else if (el.getAttribute('id') === 'mesh78') {
                  alert("Mesh78'e tıklandı!");
                }
                break;
              }
            }
          }
        });
      }
    });*/

/*function onMouseClick(event) {
  // Fare tıklamasının koordinatlarını alalım
  var mouse = new THREE.Vector2();
  mouse.x = (event.clientX / window.innerWidth) * 2 - 1;
  mouse.y = -(event.clientY / window.innerHeight) * 2 + 1;

  // Fare tıklamasını sahnede gerçek bir 3B noktaya dönüştürelim
  var raycaster = new THREE.Raycaster();
  raycaster.setFromCamera(mouse, cameraEl.object3D.children[0]);

  // Fare tıklamasının sahnede vurduğu nesneleri kontrol edelim
  var intersects = raycaster.intersectObjects(scene.children);

  // Eğer tıklama sonucunda nesneler varsa, mesh77 nesnesine tıklandı mı kontrol edelim
  if (intersects.length > 0) {
    for (var i = 0; i < intersects.length; i++) {
      if (intersects[i].object === mesh77) {
        mesh3.material.map=new THREE.TextureLoader().load( image1,function (texture) {
    // Yükleme tamamlandığında çalışacak işlev
    console.log('Texture loaded successfully:'+ texture);
   
  },
  function (xhr) {
    // Yükleme sırasında ilerleme raporları için çalışacak işlev
    var percentComplete = (xhr.loaded / xhr.total) * 100;
    console.log('Texture loading progress:'+ percentComplete + '%');
  },
  function (error) {
    // Yükleme sırasında bir hata oluşursa çalışacak işlev
    console.error('Error loading texture:'+ error);
  } );
        // Burada mesh77'ye tıklandı. İstediğiniz eylemi burada gerçekleştirebilirsiniz.
        //alert("Mesh77'e tıklandı!");
        break; // Eğer birden fazla aynı mesh varsa, sadece bir tanesini tıklanmış olarak kabul edelim.
      }
      else if(intersects[i].object===mesh78) {
        mesh3.material.map=new THREE.TextureLoader().load( image4,function (texture) {
    // Yükleme tamamlandığında çalışacak işlev
    console.log('Texture loaded successfully:'+ texture);
 
  },
  function (xhr) {
    // Yükleme sırasında ilerleme raporları için çalışacak işlev
    var percentComplete = (xhr.loaded / xhr.total) * 100;
    console.log('Texture loading progress:'+ percentComplete + '%');
  },
  function (error) {
    // Yükleme sırasında bir hata oluşursa çalışacak işlev
    console.error('Error loading texture:'+ error);
  } );
       // alert("mesh78'e tıklandı");
        break;
      }
    }
  }
}
window.addEventListener('click', onMouseClick, false);*/

document.querySelector('#cursor').addEventListener('animationcomplete__click', function() {
     // alert('Animasyon tamamlandı!');

        mesh3.material.map=new THREE.TextureLoader().load( image1,function (texture) {
    // Yükleme tamamlandığında çalışacak işlev
    console.log('Texture loaded successfully:'+ texture);
   
  },
  function (xhr) {
    // Yükleme sırasında ilerleme raporları için çalışacak işlev
    var percentComplete = (xhr.loaded / xhr.total) * 100;
    console.log('Texture loading progress:'+ percentComplete + '%');
  },
  function (error) {
    // Yükleme sırasında bir hata oluşursa çalışacak işlev
    console.error('Error loading texture:'+ error);
  } );
    });

AFRAME.registerComponent('showalert', {
      init: function () {
        var self = this;

        this.el.addEventListener('hover-start', function () {
          alert('Üzerine gelindi!');
        });
      }
    });
        }
    </script>
  <!-- A-Frame ile oluşturulmuş VR sahnesini burada oluşturun -->
  <a-scene vr-mode-ui="enabled: true" >

    <a-assets>
      <img id="platform" src="arrow2.png">
    </a-assets>
    <a-circle src="#platform" class="box" position="-1 2 -3" radius="0.25" rotation="-10 0 -90"   raycaster="objects: [data-raycastable]" hoverable  event-set__enter="_event: hover-start; _target: #camera; _function: showalert"></a-circle>
    <a-entity raycaster="objects: .box" cursor></a-entity>
    <!-- VR içeriğini burada oluşturun -->
    <a-assets>
      <a-animation id="alertAnimation" begin="animationcomplete__click" attribute="position" from="0 1 -2" to="0 1 0"></a-animation>
    </a-assets>
    
    <a-camera look-controls mouse-cursor id="camera">
      <a-entity id="cursor" raycaster="objects: .box"
      cursor="fuse: true;" 
      material="color: black; shader: flat"
      position="0 0 -2"
      geometry="primitive: ring;radiusInner: 0.02; radiusOuter: 0.03;" 
      animation__click="property: scale; startEvents: click; easing: easeInCubic; dur: 150; from: 0.1 0.1 0.1; to: 1 1 1"
      animation__fusing="property: scale; startEvents: fusing; easing: easeInCubic; dur: 1500; from: 1 1 1; to: 0.1 0.1 0.1"
      animation__mouseleave="property: scale; startEvents: mouseleave; easing: easeInCubic; dur: 500; to: 1 1 1"
      >
      </a-entity>
     </a-camera>
  </a-scene>
</body>
</html>
